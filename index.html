<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DX MESH - Live Feed (iOS)</title>
<style>
body {
  background-color: black;
  color: #FFAA33;
  font-family: 'Courier New', monospace;
  text-align: center;
  margin: 0;
  padding: 20px;
}
h1 { margin: 20px 0; font-size: 2.5em; }
h2 { margin: 10px 0; font-size: 1.5em; }
h3 { margin: 5px 0; }
.iframe-wrapper {
  text-align: center;
  margin: 15px 5px;
  border: 2px solid #FFAA33;
  border-radius: 8px;
  overflow: hidden;
  background-color: #331a00;
  width: 100%;
  max-width: 380px;
  display: flex;
  flex-direction: column;
  align-items: center;
}
.iframe-wrapper p {
  margin: 5px 5px 0;
  font-weight: bold;
  font-size: 1.1em;
}
iframe {
  border: none;
  width: 100%;
  height: 300px;
}
.hide-button {
  margin: 5px 0 10px 0;
  padding: 5px 10px;
  background-color: #ff0000;
  color: white;
  border: none;
  border-radius: 5px;
  cursor: pointer;
}
.hide-button:hover { background-color: #cc0000; }
.iframe-height-control { margin: 20px; font-size: 1.2em; color: #FFAA33; }

/* === Responsive Grid Layout (iOS safe) === */
.container {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 15px;
  justify-items: center;
  width: 100%;
  margin: 0 auto;
  max-width: 1600px;
}

@media (max-width: 768px) {
  .container {
    grid-template-columns: 1fr;
  }
}
</style>
</head>
<body>

<h1>THE DX MEGA MESH</h1>
<h2>Liam Cottle – Live Feed</h2>
<h3>Created by SubnetConflict.</h3>
<h3>Nicked by KD.</h3>

<h3 style="background-color:#B22222; color:#FFB347; display:inline-block; padding:5px 10px; border-radius:5px;">
⚠️ Please Consider Consulting Your Local Mesh Group And Fully Read The Meshtastic Role Guidance Before Selecting The Router Role ⚠️
</h3>
<h3>For Best Viewing On Smaller Landscape Screens Please Zoom Out Your Browser to 80%</h3>

<div style="margin: 20px auto; width: 90%; max-width: 800px; text-align: center;">
  <a href="https://willp618.github.io/westmidshelpfullinks">
    <button class="hide-button" style="background-color:#FFAA33; color:black;">Home</button>
  </a>
  <p style="color:#FFAA33; margin-top:5px;"><em>Edited: 14/10/25</em></p>
</div>

<div class="iframe-height-control">
  <label for="iframe-height">Adjust Message Box Height: </label>
  <input type="range" id="iframe-height" min="100" max="500" value="300">
  <span id="iframe-height-value">300px</span>
</div>

<div class="container" id="iframe-container">
  <p style="color:#FFAA33;">Loading live nodes…</p>
</div>

<script src="iframes-data.js"></script>
<script>
  // Load all nodes dynamically
  loadDxMeshIframes('iframe-container');

  // Lazy-load iframes using IntersectionObserver
  const observer = new IntersectionObserver(entries => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        const iframe = entry.target;
        if (!iframe.src && iframe.dataset.src) iframe.src = iframe.dataset.src;
        observer.unobserve(iframe);
      }
    });
  }, { threshold: 0.1 });

  document.querySelectorAll('#iframe-container iframe').forEach(iframe => {
    // Assign data-src for lazy loading
    iframe.dataset.src = iframe.src;
    iframe.src = '';
    observer.observe(iframe);
  });

  // Iframe height control
  const iframeHeightSlider = document.getElementById('iframe-height');
  const iframeHeightValue = document.getElementById('iframe-height-value');

  iframeHeightSlider.addEventListener('input', function () {
    const height = iframeHeightSlider.value;
    iframeHeightValue.textContent = height + 'px';
    document.querySelectorAll('#iframe-container iframe').forEach(iframe => {
      iframe.style.height = height + 'px';
    });
  });
</script>
</body>
</html>
